<!DOCTYPE html>
<html>
<head>
  <title>ThingSpeak Temperature Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Temperature Over Time</h2>
  <canvas id="temperatureChart" width="600" height="400"></canvas>

  <script>
    const channelID = "3110199"; // Replace with your ThingSpeak channel number
    const readAPIKey = "EAG5JSOPGG6TUX2V"; // Replace with your Read API Key
    const fieldNumber = 1; // Field number to plot
    const resultsCount = 20; // Number of data points to fetch

    async function fetchData() {
      const url = `https://api.thingspeak.com/channels/${channelID}/fields/${fieldNumber}.json?api_key=${readAPIKey}&results=${resultsCount}`;
      try {
        const response = await fetch(url);
        const data = await response.json();

        // Extract labels (time) and values
        const labels = data.feeds.map(f => new Date(f.created_at).toLocaleTimeString());
        const values = data.feeds.map(f => parseFloat(f[`field${fieldNumber}`]));

        // Draw chart
        const ctx = document.getElementById('temperatureChart').getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: 'Temperature (°C)',
              data: values,
              borderColor: 'red',
              fill: false,
              tension: 0.2
            }]
          },
          options: {
            responsive: true,
            scales: {
              x: { display: true, title: { display: true, text: 'Time' } },
              y: { display: true, title: { display: true, text: 'Temperature (°C)' } }
            }
          }
        });
      } catch (error) {
        console.error("Error fetching data:", error);
      }
    }

    fetchData();
  </script>
</body>
</html>
